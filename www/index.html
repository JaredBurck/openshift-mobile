<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="format-detection" content="telephone=no" />
        <!--meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" /-->
		<meta name="viewport" content="user-scalable=no,width=device-width,target-densitydpi=device-mdpi,initial-scale=1,maximum-scale=1"/>
        <link rel="stylesheet" type="text/css" href="css/osm.css" />
        <link rel="stylesheet" type="text/css" href="css/rht.min.css" />
        <link rel="stylesheet" type="text/css" href="css/jquery.mobile.structure-1.3.2.min.css" />
        <title>OpenShift Mobile</title>
    </head>
    <body>

		<!-- SPLASH PAGE -->
		<div id="splash-page" data-role="page">
			<img src="img/openshift.png" style="display:block;margin-left:auto;margin-right:auto;"/>
		</div>
		<!-- END PAGE -->

		<!-- LOGIN PAGE -->
		<div id="login-page" data-role="page" clas="prerender">
			<div data-role="header">
				<h1>Login</h1>
			</div>

			<div data-role="content" data-theme="a">
				<span id="login-instruct">Login to OpenShift</span>
				<div id="login-container">
					<div data-role="fieldcontain">
						<input id="login-username" type="text" value="" placeholder="Username"/>
					</div>
					<div data-role="fieldcontain">
						<input id="login-password" type="password" value="" placeholder="Password"/>
					</div>
					<div data-role="fieldcontain">
						<fieldset data-role="controlgroup">
							<input type="radio" name="login-openshift-type-radio-group" id="login-openshift-type-radio-group-online" value="online" checked="checked" />
						     	<label for="login-openshift-type-radio-group-online">OpenShift Online</label>
						
						     	<input type="radio" name="login-openshift-type-radio-group" id="login-openshift-type-radio-group-enterprise" value="enterprise"  />
						     	<label for="login-openshift-type-radio-group-enterprise">OpenShift Enterprise</label>
						</fieldset>
					</div>
					<div data-role="fieldcontain" id="login-enterprise-url-div">
						<input id="login-enterprise-url" type="text" value="" placeholder="OpenShift Enterprise Rest Url"/>
					</div>
					
						
					<div data-role="fieldcontain">
						<input id="login-auto" type="checkbox" data-theme="a"/>
						<label for="login-auto">Automatically Login</label>
					</div>
					<div data-role="fieldcontain">
						<button id="login-submit">Login</button>
					</div>

				</div>
			</div>
		</div>
		<!-- END LOGIN PAGE -->

		<!-- DOMAINS PAGE -->
		<div id="domains-page" data-role="page" class="prerender">
			<div id="domain-nav-panel" data-role="panel" data-theme="b" class="navpanel" data-display="overlay">
				<ul data-role="listview" data-theme="b">
					<li data-role="list-divider" role="heading">Account</li>
					<li data-icon="gear"><a>Settings</a></li>
					<li data-icon="back"><a class="toLogout">Logout</a></li>
				</ul>
			</div>
			<div data-role="header">
				<a href="#domain-nav-panel" data-icon="bars" data-iconpos="notext"></a>
				<h1>Domains</h1>
			</div>

			<div data-role="content">
				<div id="domain-emtpy-list" style="display:none;text-align:center">No Domains Exist</div>
				<ul id="domain-list" data-role="listview" data-theme="a"></ul>
			</div>
		</div>
		<!-- END PAGE -->

		<!-- APPLICATIONS PAGE -->
		<div id="applications-page" data-role="page" class="prerender">
			<div id="applications-nav-panel" data-role="panel" data-theme="b" class="navpanel"  data-display="overlay">
				<ul data-role="listview" data-theme="b">
					<li data-role="list-divider" role="heading">Navigation</li>
					<li data-icon="arrow-l"><a class="toDomains">Domains</a></li>
					<li data-icon="plus"><a class="createapp">Create Application</a></li>
					<li data-role="list-divider" role="heading">Account</li>
					<li data-icon="gear"><a>Settings</a></li>
					<li data-icon="back"><a class="toLogout">Logout</a></li>
				</ul>
			</div>

			<div data-role="header">
				<a href="#applications-nav-panel" data-icon="bars" data-iconpos="notext"></a>
				<h1>Applications</h1>
				<a href="" class="createapp" data-icon="plus" data-iconpos="notext"></a>
			</div>

			<div data-role="popup" data-theme="b" id="application-popupMenu">
				<ul data-role="listview" data-inset="true" style="min-width:210px;" data-theme="a">
					<li data-role="divider" data-theme="b">Actions</li>
					<li><a id="application-view">View Application</a></li>
					<li data-icon="arrow-u"><a id="application-start">Start Application</a></li>
					<li data-icon="arrow-d"><a id="application-stop">Stop Application</a></li>
					<li data-icon="refresh"><a id="application-restart">Restart Application</a></li>
					<li data-theme="c" data-icon="delete"><a id="application-delete">Delete Application</a></li>
				</ul>
			</div>

			<div data-role="content">
				<!-- Begin Popup Dialog -->
				<div data-role="popup" id="applications-popup-alert-dialog" data-overlay-theme="a" data-theme="a" style="max-width:500px" class="ui-corner-all">
					<div data-role="header" data-theme="a" class="ui-corner-top">
						<div>
							<h3 id="applications-popup-alert-dialog-header" style="text-align:center"></h3>
						</div>
					</div>
					<div data-role="content" data-theme="a" class="ui-corner-bottom ui-content">
						<h3 id="applications-popup-alert-dialog-content" class="ui-title"></h3>
						<a href="#" data-role="button" data-inline="true" data-rel="back">OK</a>    
					</div>
				</div>
				<!-- End Popup Dialog -->			

				<!-- Begin Confirmation Dialog -->
				<div data-role="popup" id="applications-popup-confirm-dialog" data-overlay-theme="a" data-theme="a" style="max-width:500px" class="ui-corner-all">
					<div data-role="header" data-theme="a" class="ui-corner-top">
						<div>
							<h3 id="applications-popup-confirm-dialog-header" style="text-align:center"></h3>
						</div>
					</div>
					<div data-role="content" data-theme="a" class="ui-corner-bottom ui-content">
						<h3 id="applications-popup-confirm-dialog-content" class="ui-title"></h3>
						<a href="#" data-role="button" data-inline="true" id="applications-popup-confirm-dialog-no-button">No</a>
						<a href="#" data-role="button" data-inline="true" id="applications-popup-confirm-dialog-yes-button" data-theme="c">Yes</a>    
					</div>
				</div>
				<!-- End Confirmation Dialog -->
				<div id="application-emtpy-list" style="display:none;text-align:center">No Applications Exist</div>
				<ul id="application-list" data-role="listview" data-theme="a" data-split-icon="arrow-d"></ul>
			</div>
		</div>
		<!-- END PAGE -->

        <!--script type="text/javascript" src="phonegap.js"></script-->
		<script type="text/javascript" src="js/jquery-1.10.2.min.js"></script>
		<script type="text/javascript" src="js/osm-framework.js"></script>
		<script type="text/javascript" src="js/osm-operations.js"></script>
		<script type="text/javascript">
			var app = OSM_Application();

			$(document).bind('osm-ready',function() {
				var settings = app.settings.load();

				$.mobile.changePage('#login-page',{transition:DEFAULT_TRANSITION});
				populateLoginForm(settings);

				if(settings.autolog) {
					loginToggleDisableFields();
					login(app,loginSuccess,loginFail);
				}
			});

			$('#login-submit').click(function() {
				var ent = $('#login-openshift-type-radio-group-enterprise').prop('checked');

				app.settings.save({
					username: $('#login-username').val(),
					password: $('#login-password').val(),
					autolog: $('#login-auto').prop('checked'),
					enterprise: ent,
					baseurl: ent ? $('#login-enterprise-url').val() : OPENSHIFT_ONLINE_URL
				});

				loginToggleDisableFields();
				login(app,loginSuccess,loginFail);
			});

			function populateLoginForm(settings) {
				$('#login-username').val(settings.username);
				$('#login-password').val(settings.password);
				$('#login-enterprise-url').val(settings.baseurl);
				$('#login-auto').prop('checked',settings.autolog).checkboxradio('refresh');
				$('#login-openshift-type-radio-group-enterprise').prop('checked',settings.enterprise).checkboxradio('refresh');
				$('#login-openshift-type-radio-group-online').prop('checked',!settings.enterprise).checkboxradio('refresh');
				$("input[name='login-openshift-type-radio-group']").change();
			}

			function loginToggleDisableFields() {
				$('#login-container').children().toggleClass('ui-disabled');
			}

			function loginSuccess(d) {
				$.mobile.changePage('#domains-page',{transition:DEFAULT_TRANSITION});
				loginToggleDisableFields();
				$.mobile.loading('hide');
			}

			function loginFail() {
				$('#login-instruct').text('Login Failed').css({'color':'#cc0000'});
				loginToggleDisableFields();
				$.mobile.loading('hide');
			}

			$("input[name='login-openshift-type-radio-group']").change(function(e){
				var enterprise_url_textbox_div = $("#login-enterprise-url-div");
			    if($('#login-openshift-type-radio-group-enterprise').prop('checked')) {
    				enterprise_url_textbox_div.show();
			    } else {
    				enterprise_url_textbox_div.hide();
			    }
			});

			$('#domains-page').bind('pagebeforeshow',{app:app,list_id:'#domain-list',app_page_id:"#applications-page"},domain_list_build);
			$('#applications-page').bind('pagebeforeshow',{app:app,list_id:'#application-list'},application_list_build);

			$('#application-start').click(function() {
				process_application_action(app,'#application-popupMenu','#application-list','start','Starting','Started');
			});

			$('#application-stop').click(function() {
				process_application_action(app,'#application-popupMenu','#application-list','stop','Stopping','Stopped');
			});

			$('#application-restart').click(function() {
				process_application_action(app,'#application-popupMenu','#application-list','restart','Restarting','Restarted');
			});

			$('#application-view').click(function() {
				$('#application-popupMenu').popup('close');
				window.open(JSON.parse(localStorage[app.support.is_supported('applications.list',localStorage['sel_domain']).url]).data[localStorage['sel_application']].app_url,'_blank','location=no');
			});
	
			$('#application-delete').click(function() {
				//TODO: Implement
			});

        </script>

		<!-- IMPORTANT: Load this last to make sure all event bindings are set before the events fire -->		
		<script type="text/javascript" src="js/jquery.mobile-1.3.2.min.js"></script>
    </body>
</html>
